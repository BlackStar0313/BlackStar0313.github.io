"use strict";(self.webpackChunk_0313_blog=self.webpackChunk_0313_blog||[]).push([[9203],{9957:(t,n,a)=>{a.r(n),a.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>c,frontMatter:()=>i,metadata:()=>e,toc:()=>p});const e=JSON.parse('{"id":"Unity/Shader/\u793a\u4f8b\u4e4b\u7b80\u5355\u7684PBR","title":"\u793a\u4f8b\u4e4b\u7b80\u5355\u7684PBR","description":"\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684PBR Shader","source":"@site/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u7b80\u5355\u7684PBR.md","sourceDirName":"Unity/Shader","slug":"/Unity/Shader/\u793a\u4f8b\u4e4b\u7b80\u5355\u7684PBR","permalink":"/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u7b80\u5355\u7684PBR","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u7b80\u5355\u7684PBR.md","tags":[],"version":"current","sidebarPosition":1019,"frontMatter":{"title":"\u793a\u4f8b\u4e4b\u7b80\u5355\u7684PBR","date":"2025-04-01T10:41:44.000Z","categories":["Unity","Shader"],"sidebar_position":1019},"sidebar":"tutorialSidebar","previous":{"title":"\u793a\u4f8b\u4e4b\u6cd5\u7ebf\u8d34\u56fe","permalink":"/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u6cd5\u7ebf\u8d34\u56fe"},"next":{"title":"\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c","permalink":"/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c"}}');var o=a(4848),r=a(8453);const i={title:"\u793a\u4f8b\u4e4b\u7b80\u5355\u7684PBR",date:new Date("2025-04-01T10:41:44.000Z"),categories:["Unity","Shader"],sidebar_position:1019},l=void 0,s={},p=[{value:"\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684PBR Shader",id:"\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684pbr-shader",level:2}];function u(t){const n={code:"code",h2:"h2",img:"img",p:"p",pre:"pre",...(0,r.R)(),...t.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684pbr-shader",children:"\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684PBR Shader"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"PBR"})," (Physically Based Rendering\uff0c\u7269\u7406\u57fa\u7840\u6e32\u67d3) \u662f\u4e00\u79cd\u57fa\u4e8e\u771f\u5b9e\u4e16\u754c\u7269\u7406\u89c4\u5f8b\u6a21\u62df\u5149\u7ebf\u548c\u6750\u8d28\u4ea4\u4e92\u7684\u6e32\u67d3\u6280\u672f\u3002\u5b83\u5728\u8fd1\u5e74\u6765\u5df2\u6210\u4e3a\u6e38\u620f\u548c\u5b9e\u65f63D\u5e94\u7528\u4e2d\u7684\u6807\u51c6\u6e32\u67d3\u65b9\u6cd5\u3002"]}),"\n",(0,o.jsx)(n.p,{children:"\u533a\u522b\u4e8e\u4f20\u7edf\u7684\u7740\u8272\u6a21\u578b\uff0cURP\u4e2d\u5185\u7f6e\u4e86PBR\u7684\u8ba1\u7b97\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528UniversalFragmentPBR\u6765\u8ba1\u7b97PBR\u7684\u6548\u679c\uff0c\u586b\u5165\u5404\u79cd\u53c2\u6570\u6a21\u62df\u7269\u7406\u5149\u7167\u6548\u679c."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"\u793a\u4f8b\u56fe",src:a(130).A+"",width:"640",height:"314"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'Shader "Custom/URPLitSimplePBR"\n{\n    Properties\n    {\n        _MainTex ("Texture", 2D) = "white" {}\n\t\t_BaseColor ("Base Color", Color) = (1,1,1,1)\n\t\t[Normal]_NormalMap ("Normal Map", 2D) = "bump" {}\n\t\t_MetallicGlossMap ("Metallic Gloss Map", 2D) = "white" {}\n\t\t_Metallic ("Metallic", Range(0, 1)) = 0\n\t\t_Smoothness ("Smoothness", Range(0, 1)) = 0.5 \n    }\n\n\tSubShader\n\t{\n\t\tTags\n\t\t{\n\t\t\t"RenderType"="Opaque"\n\t\t\t"RenderPipeline"="UniversalPipeline"\n\t\t}\n\n\t\tPass\n\t\t{\n            \n\t\t\tHLSLPROGRAM\n\t\t\t#pragma vertex vert\n\t\t\t#pragma fragment frag\n            \n\t\t\t#include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl"\n\t\t\t#include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Lighting.hlsl"\n\n\t\t\tTEXTURE2D(_MainTex);\n\t\t\tSAMPLER(sampler_MainTex);\n\t\t\tTEXTURE2D(_NormalMap);\n\t\t\tSAMPLER(sampler_NormalMap);\n\t\t\tTEXTURE2D(_MetallicGlossMap);\n\t\t\tSAMPLER(sampler_MetallicGlossMap);\n\n\t\t\tCBUFFER_START(UnityPerMaterial)\n\t\t\t\tfloat4 _MainTex_ST;\n\t\t\t\tfloat4 _NormalMap_ST;\n\t\t\t\tfloat4 _MetallicGlossMap_ST;\n\t\t\t\tfloat4 _BaseColor;\n\t\t\t\tfloat _Metallic;\n\t\t\t\tfloat _Smoothness;\n\t\t\tCBUFFER_END\n\n\t\t\tstruct Attributes\n\t\t\t{\n\t\t\t\tfloat4 positionOS : POSITION;\n\t\t\t\tfloat3 normalOS : NORMAL ;\n\t\t\t\tfloat4 tangentOS : TANGENT;\n\t\t\t\tfloat2 uv : TEXCOORD0;\n\t\t\t};\n\n\t\t\tstruct Varyings\n\t\t\t{\n\t\t\t\tfloat4 positionCS: SV_POSITION;\n\t\t\t\tfloat2 uv: TEXCOORD0;\n\t\t\t\tfloat3 positionWS: TEXCOORD1;\n\t\t\t\tfloat3 normalWS: NORMAL;\n\t\t\t\tfloat4 tangentWS: TEXCOORD2;\n\t\t\t\tfloat3 bitangentWS: TEXCOORD3;\n\t\t\t};\n\n\n\t\t\tVaryings vert(Attributes input)\n\t\t\t{\n\t\t\t\tVaryings output;\n\t\t\t\toutput.positionCS = TransformObjectToHClip(input.positionOS.xyz);\n\t\t\t\toutput.positionWS = TransformObjectToWorld(input.positionOS.xyz);\n\t\t\t\toutput.uv = TRANSFORM_TEX(input.uv, _MainTex);\n\n\t\t\t\t//\u8ba1\u7b97TBN\u77e9\u9635\u76f8\u5173\u53c2\u6570\n\t\t\t\toutput.normalWS = TransformObjectToWorldNormal(input.normalOS);\n\t\t\t\toutput.tangentWS = float4(TransformObjectToWorldDir(input.tangentOS.xyz), input.tangentOS.w);\n\t\t\t\toutput.bitangentWS = cross(output.normalWS, output.tangentWS.xyz) * input.tangentOS.w;\n\t\t\t\treturn output;\n\t\t\t}\n\n\t\t\thalf4 frag(Varyings input) : SV_TARGET\n\t\t\t{\n\t\t\t\thalf4 albedoMap = SAMPLE_TEXTURE2D(_MainTex, sampler_MainTex, input.uv);\n\t\t\t\thalf3 albedo = albedoMap.rgb * _BaseColor.rgb;\n\n\t\t\t\t//\u4ece\u6cd5\u7ebf\u8d34\u56fe\u83b7\u53d6\u6cd5\u7ebf\n\t\t\t\thalf4 normalMap = SAMPLE_TEXTURE2D(_NormalMap, sampler_NormalMap, input.uv);\n\t\t\t\thalf3 normalTS = UnpackNormal(normalMap);\n\n\t\t\t\t//\u6784\u5efaTBN\u77e9\u9635\n\t\t\t\tfloat3x3 TBN = float3x3(\n\t\t\t\t\tnormalize(input.tangentWS.xyz),\n\t\t\t\t\tnormalize(input.bitangentWS),\n\t\t\t\t\tnormalize(input.normalWS)\n\t\t\t\t);\n\t\t\t\thalf3 normalWS = mul(normalTS, TBN); \n\t\t\t\tnormalWS = normalize(normalWS);\n\n\t\t\t\t//\u4ece\u91d1\u5c5e\u5149\u6cfd\u8d34\u56fe\u83b7\u53d6\u91d1\u5c5e\u5149\u6cfd\u53c2\u6570\n\t\t\t\thalf4 metallicGlossMap = SAMPLE_TEXTURE2D(_MetallicGlossMap, sampler_MetallicGlossMap, input.uv);\n\t\t\t\thalf metallic = metallicGlossMap.r * _Metallic;\n\t\t\t\thalf smoothness = metallicGlossMap.a * _Smoothness;\n\n\t\t\t\t//\u51c6\u5907\u8f93\u5165\u6570\u636e\n\t\t\t\tInputData inputData = (InputData)0;\n\t\t\t\tinputData.positionWS = input.positionWS;\n\t\t\t\tinputData.normalWS = normalWS;\n\t\t\t\tinputData.viewDirectionWS = normalize(GetWorldSpaceViewDir(input.positionWS));\n\t\t\t\tinputData.shadowCoord = TransformWorldToShadowCoord(input.positionWS);\n\t\t\t\t\n\t\t\t\t// inputData.normalizedScreenSpaceUV = GetNormalizedScreenSpaceUV(input.positionCS);\n\t\t\t\tinputData.shadowMask = half4(1, 1, 1, 1);\n\t\t\t\tinputData.fogCoord = 0;\n\t\t\t\tinputData.vertexLighting = half3(0, 0, 0);\n\t\t\t\tinputData.bakedGI =  albedo; // SampleSH(normalWS); // \u4f7f\u7528\u7403\u8c10\u5149\u7167\u91c7\u6837\u73af\u5883\u5149\n\t\t\t\t// inputData.tangentToWorld = CreateTangentToWorld(normalWS, input.tangentWS.xyz, input.tangentWS.w);\n\n\t\t\t\t//\u51c6\u5907\u8868\u9762\u6570\u636e\n\t\t\t\tSurfaceData surfaceData = (SurfaceData)0;\n\t\t\t\tsurfaceData.albedo = albedo;\n\t\t\t\tsurfaceData.metallic = metallic;\n\t\t\t\tsurfaceData.smoothness = smoothness;\n\t\t\t\tsurfaceData.normalTS = normalTS;\n\t\t\t\tsurfaceData.emission = half3(0, 0, 0); \n\t\t\t\tsurfaceData.occlusion = 1;\n\t\t\t\tsurfaceData.alpha = 1;\n\t\t\t\tsurfaceData.clearCoatMask = 0;\n\t\t\t\tsurfaceData.clearCoatSmoothness = 0;\n\n\t\t\t\t//\u4f7f\u7528UniversalForward\u6e32\u67d3\n\t\t\t\thalf4 color = UniversalFragmentPBR(inputData, surfaceData);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\treturn color;\n\t\t\t}\n\n\t\t\tENDHLSL\n\t\t}\n\t}\n}\n'})})]})}function c(t={}){const{wrapper:n}={...(0,r.R)(),...t.components};return n?(0,o.jsx)(n,{...t,children:(0,o.jsx)(u,{...t})}):u(t)}},130:(t,n,a)=>{a.d(n,{A:()=>e});const e=a.p+"assets/images/samplePBR-a201b9433d7dae1d517def161fc5c9b6.gif"},8453:(t,n,a)=>{a.d(n,{R:()=>i,x:()=>l});var e=a(6540);const o={},r=e.createContext(o);function i(t){const n=e.useContext(r);return e.useMemo((function(){return"function"==typeof t?t(n):{...n,...t}}),[n,t])}function l(t){let n;return n=t.disableParentContext?"function"==typeof t.components?t.components(o):t.components||o:i(t.components),e.createElement(r.Provider,{value:n},t.children)}}}]);