"use strict";(self.webpackChunk_0313_blog=self.webpackChunk_0313_blog||[]).push([[3655],{1911:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c","title":"\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c","description":"\u8fd9\u662f\u4e00\u4e2a\u5361\u901a\u98ce\u683c\u7684Shader","source":"@site/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c.md","sourceDirName":"Unity/Shader","slug":"/Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c","permalink":"/zh-Hans/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c.md","tags":[],"version":"current","sidebarPosition":1020,"frontMatter":{"title":"\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c","date":"2025-04-01T10:41:44.000Z","categories":["Unity","Shader"],"sidebar_position":1020},"sidebar":"tutorialSidebar","previous":{"title":"\u793a\u4f8b\u4e4b\u7b80\u5355\u7684PBR","permalink":"/zh-Hans/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u7b80\u5355\u7684PBR"},"next":{"title":"\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c\u989d\u5916\u6548\u679c","permalink":"/zh-Hans/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c\u989d\u5916\u6548\u679c"}}');var o=e(4848),r=e(8453);const i={title:"\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c",date:new Date("2025-04-01T10:41:44.000Z"),categories:["Unity","Shader"],sidebar_position:1020},l=void 0,s={},d=[{value:"\u8fd9\u662f\u4e00\u4e2a\u5361\u901a\u98ce\u683c\u7684Shader",id:"\u8fd9\u662f\u4e00\u4e2a\u5361\u901a\u98ce\u683c\u7684shader",level:2},{value:"\u5361\u901a\u6e32\u67d3\u7684\u6838\u5fc3\u539f\u7406",id:"\u5361\u901a\u6e32\u67d3\u7684\u6838\u5fc3\u539f\u7406",level:4},{value:"\u5e73\u6ed1\u6b65\u8fdb\u51fd\u6570\u521b\u5efa\u786c\u8fb9\u754c",id:"\u5e73\u6ed1\u6b65\u8fdb\u51fd\u6570\u521b\u5efa\u786c\u8fb9\u754c",level:4},{value:"\u4e3a\u4ec0\u4e48\u8fd9\u662f\u5361\u901a\u6548\u679c\uff1a",id:"\u4e3a\u4ec0\u4e48\u8fd9\u662f\u5361\u901a\u6548\u679c",level:4},{value:"\u89c6\u89c9\u6548\u679c\u5bf9\u6bd4",id:"\u89c6\u89c9\u6548\u679c\u5bf9\u6bd4",level:4},{value:"\u4ee3\u7801\u5b9e\u73b0",id:"\u4ee3\u7801\u5b9e\u73b0",level:4}];function h(t){const n={code:"code",h2:"h2",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...t.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h2,{id:"\u8fd9\u662f\u4e00\u4e2a\u5361\u901a\u98ce\u683c\u7684shader",children:"\u8fd9\u662f\u4e00\u4e2a\u5361\u901a\u98ce\u683c\u7684Shader"}),"\n",(0,o.jsx)(n.h4,{id:"\u5361\u901a\u6e32\u67d3\u7684\u6838\u5fc3\u539f\u7406",children:"\u5361\u901a\u6e32\u67d3\u7684\u6838\u5fc3\u539f\u7406"}),"\n",(0,o.jsx)(n.p,{children:"\u4f20\u7edf\u7684\u771f\u5b9e\u611f\u6e32\u67d3\u4f1a\u5e73\u6ed1\u8fc7\u6e21\u5149\u7167\u503c\uff0c\u800c\u5361\u901a\u6e32\u67d3\u5219\u662f\u5c06\u5149\u7167\u5206\u6210\u6709\u9650\u7684\u51e0\u4e2a\u533a\u57df\uff0c\u5f62\u6210\u9c9c\u660e\u7684\u8272\u5757\u5bf9\u6bd4\u3002"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"\u793a\u4f8b\u56fe",src:e(934).A+"",width:"640",height:"314"})}),"\n",(0,o.jsx)(n.h4,{id:"\u5e73\u6ed1\u6b65\u8fdb\u51fd\u6570\u521b\u5efa\u786c\u8fb9\u754c",children:"\u5e73\u6ed1\u6b65\u8fdb\u51fd\u6570\u521b\u5efa\u786c\u8fb9\u754c"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:"float toonRamp = smoothstep(_ShadowThreshold - _ShadowSmoothness, _ShadowThreshold + _ShadowSmoothness, lightIntensity);\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"lightIntensity: \u539f\u59cb\u5149\u7167\u5f3a\u5ea6\uff0c\u503c\u8303\u56f4\u5728-1\u52301\u4e4b\u95f4\uff0c\u662f\u4ece\u6cd5\u7ebf\u548c\u5149\u7167\u65b9\u5411\u7684\u70b9\u79ef\u8ba1\u7b97\u5f97\u5230"}),"\n",(0,o.jsx)(n.li,{children:"_ShadowThreshold: \u660e\u6697\u5206\u754c\u9608\u503c\uff08\u4f8b\u59820.5\uff09"}),"\n",(0,o.jsx)(n.li,{children:"_ShadowSmoothness: \u8fb9\u754c\u5e73\u6ed1\u7a0b\u5ea6\uff08\u8f83\u5c0f\u503c\u59820.01\u4f1a\u4ea7\u751f\u975e\u5e38\u786c\u7684\u8fb9\u754c\uff09"}),"\n",(0,o.jsx)(n.li,{children:"smoothstep\u51fd\u6570: \u6267\u884c\u4ece0\u52301\u7684\u5e73\u6ed1\u8fc7\u6e21\uff0c\u4f46\u53ea\u5728\u975e\u5e38\u72ed\u7a84\u7684\u8303\u56f4\u5185\u53d1\u751f"}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"\u4e3a\u4ec0\u4e48\u8fd9\u662f\u5361\u901a\u6548\u679c",children:"\u4e3a\u4ec0\u4e48\u8fd9\u662f\u5361\u901a\u6548\u679c\uff1a"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\u4f20\u7edf\u5149\u7167\u4f1a\u5e73\u6ed1\u5730\u4ece0\u8fc7\u6e21\u52301"}),"\n",(0,o.jsx)(n.li,{children:"\u800c\u8fd9\u91cc\u6211\u4eec\u8ba9\u8fc7\u6e21\u53ea\u53d1\u751f\u5728\u4e00\u4e2a\u5f88\u7a84\u7684\u8303\u56f4\uff08\u7531_ShadowSmoothness\u63a7\u5236\uff09"}),"\n",(0,o.jsx)(n.li,{children:"\u8fd9\u521b\u9020\u4e86\u7a81\u5140\u7684\u660e\u6697\u5206\u754c\uff0c\u6a21\u62df\u624b\u7ed8\u52a8\u753b\u4e2d\u7684\u5e73\u6d82\u8272\u5757\u548c\u786c\u8fb9\u754c"}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"\u89c6\u89c9\u6548\u679c\u5bf9\u6bd4",children:"\u89c6\u89c9\u6548\u679c\u5bf9\u6bd4"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"\u771f\u5b9e\u6e32\u67d3\uff1a\u5149\u7167\u968f\u89d2\u5ea6\u5e73\u6ed1\u53d8\u5316\uff0c\u5f62\u6210\u8fde\u7eed\u7684\u660e\u6697\u8fc7\u6e21"}),"\n",(0,o.jsx)(n.li,{children:"\u5361\u901a\u6e32\u67d3\uff1a\u5927\u9762\u79ef\u7684\u5e73\u6d82\u8272\u5757\uff0c\u660e\u6697\u4e4b\u95f4\u6709\u6e05\u6670\u8fb9\u754c"}),"\n"]}),"\n",(0,o.jsx)(n.h4,{id:"\u4ee3\u7801\u5b9e\u73b0",children:"\u4ee3\u7801\u5b9e\u73b0"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-csharp",children:'Shader "Custom/URPToonShading"\n{\n\tProperties\n\t{\n\t\t_MainTex ("Texture", 2D) = "white" {}\n\t\t_BaseColor ("Base Color", Color) = (1, 1, 1, 1)\n\t\t_ShadowColor ("Shadow Color", Color) = (0.5, 0.5, 0.5, 1)\n\t\t_ShadowThreshold ("Shadow Threshold", Range(0, 1)) = 0.5\n\t\t_ShadowSmoothness ("Shadow Smoothness", Range(0, 0.2)) = 0.01\n\t\t[Toggle] _UseRamp ("Use Ramp", Float) = 0\n\t\t_RampTex ("Ramp Texture", 2D) = "white" {}\n\t\t[Normal] _NormalMap ("Normal Map", 2D) = "bump" {}\n\t\t_OutlineWidth ("Outline Width", Range(0, 0.1)) = 0.01\n\t\t_OutlineColor ("Outline Color", Color) = (0, 0, 0, 1)\n\t}\n\n\tSubShader\n\t{\n\t\tTags\n\t\t{\n\t\t\t"RenderType"="Opaque"\n\t\t\t"RenderPipeline"="UniversalPipeline"\n\t\t}\n\t\t\n\t\tPass\n\t\t{\n\t\t\tName "ForwardLit"\n\t\t\tTags { "LightMode"="UniversalForward" }\n\n\t\t\tHLSLPROGRAM\n\t\t\t#pragma vertex vert\n\t\t\t#pragma fragment frag\n\t\t\t#pragma multi_compile _ _MAIN_LIGHT_SHADOWS\n\t\t\t#pragma multi_compile _ _SHADOWS_SOFT\n\n\t\t\t#include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl"\n\t\t\t#include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Lighting.hlsl"\n\n\t\t\tTEXTURE2D(_MainTex);\n\t\t\tSAMPLER(sampler_MainTex);\n            TEXTURE2D(_NormalMap);\n\t\t\tSAMPLER(sampler_NormalMap);\n\t\t\tTEXTURE2D(_RampTex);\n\t\t\tSAMPLER(sampler_RampTex);\n\n\t\t\tCBUFFER_START(UnityPerMaterial)\n\t\t\tfloat4 _MainTex_ST;\n\t\t\tfloat4 _BaseColor;\n\t\t\tfloat4 _ShadowColor;\n\t\t\tfloat4 _NormalMap_ST;\n\t\t\tfloat4 _RampTex_ST;\n\t\t\tfloat _UseRamp;\n\t\t\tfloat4 _OutlineColor;\n\t\t\tfloat _OutlineWidth;\n\t\t\tfloat _ShadowThreshold;\n\t\t\tfloat _ShadowSmoothness;\n\t\t\tCBUFFER_END\n\n\t\t\tstruct Attributes\n\t\t\t{\n\t\t\t\tfloat4 positionOS : POSITION;\n\t\t\t\tfloat3 normalOS : NORMAL;\n\t\t\t\tfloat4 tangentOS : TANGENT;\n\t\t\t\tfloat2 uv : TEXCOORD0;\n\t\t\t};\n\n\t\t\tstruct Varyings\n\t\t\t{\n\t\t\t\tfloat4 positionHCS : SV_POSITION;\n\t\t\t\tfloat2 uv : TEXCOORD0;\n\t\t\t\tfloat3 positionWS : TEXCOORD1;\n\t\t\t\tfloat3 normalWS : TEXCOORD2;\n\t\t\t\tfloat4 tangentWS : TEXCOORD3;\n\t\t\t\tfloat3 bitangentWS : TEXCOORD4;\n\t\t\t};\n\n\t\t\tVaryings vert(Attributes input)\n\t\t\t{\n\t\t\t\tVaryings output;\n\t\t\t\toutput.positionHCS = TransformObjectToHClip(input.positionOS.xyz);\n\t\t\t\toutput.positionWS = TransformObjectToWorld(input.positionOS.xyz);\n\t\t\t\toutput.uv = TRANSFORM_TEX(input.uv, _MainTex);\n\n\t\t\t\t// \u8ba1\u7b97TBN\u77e9\u9635\n\t\t\t\toutput.normalWS = TransformObjectToWorldNormal(input.normalOS);\n\t\t\t\toutput.tangentWS = float4(TransformObjectToWorldDir(input.tangentOS.xyz), input.tangentOS.w);\n\t\t\t\toutput.bitangentWS = cross(output.normalWS, output.tangentWS.xyz) * input.tangentOS.w;\n\n\t\t\t\treturn output;\n\t\t\t}\n\n\t\t\thalf4 frag(Varyings input) : SV_TARGET\n\t\t\t{\n\t\t\t\thalf4 albedo = SAMPLE_TEXTURE2D(_MainTex, sampler_MainTex, input.uv);\n\t\t\t\thalf3 albedoColor = albedo.rgb * _BaseColor.rgb;\n\n\t\t\t\t//\u6cd5\u7ebf\u8d34\u56fe\n\t\t\t\thalf4 normalMap = SAMPLE_TEXTURE2D(_NormalMap, sampler_NormalMap, input.uv);\n\t\t\t\thalf3 normalTS = UnpackNormal(normalMap);\n\n\t\t\t\t// \u6784\u5efaTBN\u77e9\u9635\n\t\t\t\tfloat3x3 TBN = float3x3(\n\t\t\t\t\tnormalize(input.tangentWS.xyz),\n\t\t\t\t\tnormalize(input.bitangentWS),\n\t\t\t\t\tnormalize(input.normalWS)\n\t\t\t\t);\n\t\t\t\thalf3 normalWS = mul(normalTS, TBN);\n\n\t\t\t\t// lambert \u6f2b\u53cd\u5c04\n\t\t\t\tLight mainLight = GetMainLight();\n\t\t\t\tfloat lightIntensity = dot(normalWS , mainLight.direction);\n\n\t\t\t\t// \u5361\u901a\u9634\u5f71\u8ba1\u7b97   \u4f7f\u7528\u5e73\u6ed1\u6b65\u8fdb\u521b\u5efa\u786c\u8fb9\u754c\n\t\t\t\tfloat toonRamp = smoothstep(_ShadowThreshold - _ShadowSmoothness, _ShadowThreshold + _ShadowSmoothness, lightIntensity);\n\n\t\t\t\t// \u6e10\u53d8\u7eb9\u7406\n\t\t\t\tif (_UseRamp > 0.5) {\n\t\t\t\t\ttoonRamp = SAMPLE_TEXTURE2D(_RampTex, sampler_RampTex, float2(toonRamp, 0.5)).r;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// \u9634\u5f71\u989c\u8272\n\t\t\t\thalf3 shadowedColor = albedoColor * _ShadowColor.rgb ;\n\t\t\t\thalf3 litColor = albedoColor * mainLight.color; \n\n\t\t\t\t// \u6700\u7ec8\u989c\u8272\u6df7\u5408  - \u5728\u660e\u6697\u533a\u57df\u4e4b\u95f4\u5dee\u503c\n\t\t\t\thalf3 finalColor = lerp(shadowedColor, litColor, toonRamp);\n\n\t\t\t\t//\u6dfb\u52a0\u57fa\u7840\u73af\u5883\u5149\n\t\t\t\thalf3 ambient = half3(0.1, 0.1, 0.1) * albedoColor;\n\t\t\t\tfinalColor += ambient;\n\n\t\t\t\treturn half4(finalColor, 1);\n\t\t\t\t\n\t\t\t}\n\t\t\tENDHLSL\n\t\t}\n\n\t\t// \u7b2c\u4e8c\u4e2aPass - \u8f6e\u5ed3\u7ebf\n\t\tPass\n\t\t{\n\t\t\tName "Outline"\n\t\t\tTags {}\n\t\t\tCull Front //\u8e22\u51fa\u6b63\u9762  \u53ea\u6e32\u67d3\u80cc\u9762\n\t\t\tHLSLPROGRAM\n\t\t\t#pragma vertex vert\n\t\t\t#pragma fragment frag\n\n\t\t\t#include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl"\n\n\t\t\tCBUFFER_START(UnityPerMaterial)\n\t\t\tfloat4 _OutlineColor;\n\t\t\tfloat _OutlineWidth;\n\t\t\tCBUFFER_END\n\n\t\t\tstruct Attributes\n\t\t\t{\n\t\t\t\tfloat4 positionOS : POSITION;\n\t\t\t\tfloat3 normalOS : NORMAL;\n\t\t\t};\n\n\t\t\tstruct Varyings\n\t\t\t{\n\t\t\t\tfloat4 positionCS : SV_POSITION;\n\t\t\t};\n\n\t\t\tVaryings vert(Attributes input)\n\t\t\t{\n\t\t\t\tVaryings output;\n\n\t\t\t\t// \u6cd5\u7ebf\u65b9\u5411\u5916\u6269\u70b9\n\t\t\t\tfloat3 positionOS = input.positionOS.xyz + input.normalOS * _OutlineWidth;\n\t\t\t\toutput.positionCS = TransformObjectToHClip(positionOS);\n\t\t\t\treturn output;\n\t\t\t}\n\n\t\t\thalf4 frag(Varyings input) : SV_TARGET\n\t\t\t{\n\t\t\t\treturn _OutlineColor;\n\t\t\t}\n\n\t\t\tENDHLSL\n\t\t}\n\n\t\t// // \u7b2c\u4e09\u4e2aPass - \u6295\u5c04\u9634\u5f71\n\t\t// UsePass "Universal Render Pipeline/Lit/ShadowCaster"\n\t}\n}\n'})})]})}function u(t={}){const{wrapper:n}={...(0,r.R)(),...t.components};return n?(0,o.jsx)(n,{...t,children:(0,o.jsx)(h,{...t})}):h(t)}},934:(t,n,e)=>{e.d(n,{A:()=>a});const a=e.p+"assets/images/toonshading-a34495a1d6579b0ce17b13b702a7a0d5.gif"},8453:(t,n,e)=>{e.d(n,{R:()=>i,x:()=>l});var a=e(6540);const o={},r=a.createContext(o);function i(t){const n=a.useContext(r);return a.useMemo((function(){return"function"==typeof t?t(n):{...n,...t}}),[n,t])}function l(t){let n;return n=t.disableParentContext?"function"==typeof t.components?t.components(o):t.components||o:i(t.components),a.createElement(r.Provider,{value:n},t.children)}}}]);