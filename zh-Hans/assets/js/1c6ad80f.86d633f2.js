"use strict";(self.webpackChunk_0313_blog=self.webpackChunk_0313_blog||[]).push([[9202],{598:(t,n,o)=>{o.r(n),o.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>l,metadata:()=>e,toc:()=>p});const e=JSON.parse('{"id":"Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c\u989d\u5916\u6548\u679c","title":"\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c\u989d\u5916\u6548\u679c","description":"\u5bf9\u4e8e\u5361\u901a\u6548\u679c\uff0c\u989d\u5916\u6dfb\u52a0\u6548\u679c","source":"@site/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c\u989d\u5916\u6548\u679c.md","sourceDirName":"Unity/Shader","slug":"/Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c\u989d\u5916\u6548\u679c","permalink":"/zh-Hans/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c\u989d\u5916\u6548\u679c","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c\u989d\u5916\u6548\u679c.md","tags":[],"version":"current","sidebarPosition":1021,"frontMatter":{"title":"\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c\u989d\u5916\u6548\u679c","date":"2025-04-03T10:41:44.000Z","categories":["Unity","Shader"],"sidebar_position":1021},"sidebar":"tutorialSidebar","previous":{"title":"\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c","permalink":"/zh-Hans/docs/Unity/Shader/\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c"},"next":{"title":"\u793a\u4f8b\u4e4bRenderFeature\u5b9e\u73b0\u8fb9\u7f18\u68c0\u6d4b\u63cf\u8fb9","permalink":"/zh-Hans/docs/Unity/Shader/\u793a\u4f8b\u4e4bRenderFeature\u5b9e\u73b0\u8fb9\u7f18\u68c0\u6d4b\u63cf\u8fb9"}}');var a=o(4848),r=o(8453);const l={title:"\u793a\u4f8b\u4e4b\u5361\u901a\u98ce\u683c\u989d\u5916\u6548\u679c",date:new Date("2025-04-03T10:41:44.000Z"),categories:["Unity","Shader"],sidebar_position:1021},i=void 0,s={},p=[];function u(t){const n={code:"code",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...t.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"\u5bf9\u4e8e\u5361\u901a\u6548\u679c\uff0c\u989d\u5916\u6dfb\u52a0\u6548\u679c"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"\u6dfb\u52a0\u652f\u6301\u591a\u7ea7\u8272\u9636"}),"\n",(0,a.jsx)(n.li,{children:"\u6dfb\u52a0\u5361\u901a\u9ad8\u5149"}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:(0,a.jsx)(n.img,{alt:"\u5361\u901a\u98ce\u683c\u989d\u5916\u6548\u679c",src:o(7408).A+"",width:"640",height:"290"})}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'Shader "Custom/URPToonShadingAdvance"\n{\n\tProperties\n\t{\n\t\t_MainTex ("Texture", 2D) = "white" {}\n\t\t_BaseColor ("Base Color", Color) = (1, 1, 1, 1)\n\t\t_ShadowColor ("Shadow Color", Color) = (0.5, 0.5, 0.5, 1)\n\t\t_ShadowThreshold ("Shadow Threshold", Range(0, 1)) = 0.5\n\t\t_ShadowSmoothness ("Shadow Smoothness", Range(0, 0.2)) = 0.01\n\t\t[Toggle] _UseRamp ("Use Ramp", Float) = 0\n\t\t_RampTex ("Ramp Texture", 2D) = "white" {}\n\t\t[Normal] _NormalMap ("Normal Map", 2D) = "bump" {}\n\t\t_OutlineWidth ("Outline Width", Range(0, 0.1)) = 0.01\n\t\t_OutlineColor ("Outline Color", Color) = (0, 0, 0, 1)\n\t\t_MidToneThreshold ("Mid Tone Threshold", Range(0, 1)) = 0.75\n\t\t_MidToneColor ("Mid Tone Color", Color) = (0.7, 0.7, 0.7, 1)\n\n\t\t_SpecularColor ("Specular Color", Color) = (1, 1, 1, 1)\n\t\t_SpecularThreshold ("Specular Threshold", Range(0, 1)) = 0.8\n\t\t_SpecularSmoothness ("Specular Smoothness", Range(0, 0.2)) = 0.05\n\t}\n\n\tSubShader\n\t{\n\t\tTags\n\t\t{\n\t\t\t"RenderType"="Opaque"\n\t\t\t"RenderPipeline"="UniversalPipeline"\n\t\t}\n\t\t\n\t\tPass\n\t\t{\n\t\t\tName "ForwardLit"\n\t\t\tTags { "LightMode"="UniversalForward" }\n\n\t\t\tHLSLPROGRAM\n\t\t\t#pragma vertex vert\n\t\t\t#pragma fragment frag\n\t\t\t#pragma multi_compile _ _MAIN_LIGHT_SHADOWS\n\t\t\t#pragma multi_compile _ _SHADOWS_SOFT\n\n\t\t\t#include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl"\n\t\t\t#include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Lighting.hlsl"\n\n\t\t\tTEXTURE2D(_MainTex);\n\t\t\tSAMPLER(sampler_MainTex);\n            TEXTURE2D(_NormalMap);\n\t\t\tSAMPLER(sampler_NormalMap);\n\t\t\tTEXTURE2D(_RampTex);\n\t\t\tSAMPLER(sampler_RampTex);\n\n\t\t\tCBUFFER_START(UnityPerMaterial)\n\t\t\tfloat4 _MainTex_ST;\n\t\t\tfloat4 _BaseColor;\n\t\t\tfloat4 _ShadowColor;\n\t\t\tfloat4 _NormalMap_ST;\n\t\t\tfloat4 _RampTex_ST;\n\t\t\tfloat _UseRamp;\n\t\t\tfloat4 _OutlineColor;\n\t\t\tfloat _OutlineWidth;\n\t\t\tfloat _ShadowThreshold;\n\t\t\tfloat _ShadowSmoothness;\n\t\t\tfloat _MidToneThreshold;\n\t\t\tfloat4 _MidToneColor;\n\t\t\tfloat4 _SpecularColor;\n\t\t\tfloat _SpecularThreshold;\n\t\t\tfloat _SpecularSmoothness;\n\t\t\tCBUFFER_END\n\n\t\t\tstruct Attributes\n\t\t\t{\n\t\t\t\tfloat4 positionOS : POSITION;\n\t\t\t\tfloat3 normalOS : NORMAL;\n\t\t\t\tfloat4 tangentOS : TANGENT;\n\t\t\t\tfloat2 uv : TEXCOORD0;\n\t\t\t};\n\n\t\t\tstruct Varyings\n\t\t\t{\n\t\t\t\tfloat4 positionHCS : SV_POSITION;\n\t\t\t\tfloat2 uv : TEXCOORD0;\n\t\t\t\tfloat3 positionWS : TEXCOORD1;\n\t\t\t\tfloat3 normalWS : TEXCOORD2;\n\t\t\t\tfloat4 tangentWS : TEXCOORD3;\n\t\t\t\tfloat3 bitangentWS : TEXCOORD4;\n\t\t\t};\n\n\t\t\tVaryings vert(Attributes input)\n\t\t\t{\n\t\t\t\tVaryings output;\n\t\t\t\toutput.positionHCS = TransformObjectToHClip(input.positionOS.xyz);\n\t\t\t\toutput.positionWS = TransformObjectToWorld(input.positionOS.xyz);\n\t\t\t\toutput.uv = TRANSFORM_TEX(input.uv, _MainTex);\n\n\t\t\t\t// \u8ba1\u7b97TBN\u77e9\u9635\n\t\t\t\toutput.normalWS = TransformObjectToWorldNormal(input.normalOS);\n\t\t\t\toutput.tangentWS = float4(TransformObjectToWorldDir(input.tangentOS.xyz), input.tangentOS.w);\n\t\t\t\toutput.bitangentWS = cross(output.normalWS, output.tangentWS.xyz) * input.tangentOS.w;\n\n\t\t\t\treturn output;\n\t\t\t}\n\n\t\t\thalf4 frag(Varyings input) : SV_TARGET\n\t\t\t{\n\t\t\t\thalf4 albedo = SAMPLE_TEXTURE2D(_MainTex, sampler_MainTex, input.uv);\n\t\t\t\thalf3 albedoColor = albedo.rgb * _BaseColor.rgb;\n\n\t\t\t\t//\u6cd5\u7ebf\u8d34\u56fe\n\t\t\t\thalf4 normalMap = SAMPLE_TEXTURE2D(_NormalMap, sampler_NormalMap, input.uv);\n\t\t\t\thalf3 normalTS = UnpackNormal(normalMap);\n\n\t\t\t\t// \u6784\u5efaTBN\u77e9\u9635\n\t\t\t\tfloat3x3 TBN = float3x3(\n\t\t\t\t\tnormalize(input.tangentWS.xyz),\n\t\t\t\t\tnormalize(input.bitangentWS),\n\t\t\t\t\tnormalize(input.normalWS)\n\t\t\t\t);\n\t\t\t\thalf3 normalWS = mul(normalTS, TBN);\n\n\t\t\t\t// lambert \u6f2b\u53cd\u5c04\n\t\t\t\tLight mainLight = GetMainLight();\n\t\t\t\tfloat lightIntensity = dot(normalWS , mainLight.direction);\n\n\t\t\t\t// \u5361\u901a\u9634\u5f71\u8ba1\u7b97   \u4f7f\u7528\u5e73\u6ed1\u6b65\u8fdb\u521b\u5efa\u786c\u8fb9\u754c\n\t\t\t\tfloat toonRamp = smoothstep(_ShadowThreshold - _ShadowSmoothness, _ShadowThreshold + _ShadowSmoothness, lightIntensity);\n\t\t\t\tfloat midToneRamp = smoothstep(_MidToneThreshold - _ShadowSmoothness, _MidToneThreshold + _ShadowSmoothness, lightIntensity);\n\t\t\t\t// \u6e10\u53d8\u7eb9\u7406\n\t\t\t\tif (_UseRamp > 0.5) {\n\t\t\t\t\ttoonRamp = SAMPLE_TEXTURE2D(_RampTex, sampler_RampTex, float2(toonRamp, 0.5)).r;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t// \u9634\u5f71\u989c\u8272\n\t\t\t\thalf3 shadowedColor = albedoColor * _ShadowColor.rgb ;\n\t\t\t\thalf3 litColor = albedoColor * mainLight.color; \n\n\t\t\t\t// \u589e\u52a0\u8272\u9636\u8ba1\u7b97\n\t\t\t\thalf3 midToneColor = albedoColor * _MidToneColor.rgb;\n\n\t\t\t\t// \u6700\u7ec8\u989c\u8272\u6df7\u5408  - \u5728\u660e\u6697\u533a\u57df\u4e4b\u95f4\u5dee\u503c\n\t\t\t\thalf3 finalColor = lerp(shadowedColor, midToneColor, midToneRamp);\n\t\t\t\tfinalColor = lerp(finalColor, litColor, toonRamp);\n\n\t\t\t\t//\u6dfb\u52a0\u57fa\u7840\u73af\u5883\u5149\n\t\t\t\thalf3 ambient = half3(0.1, 0.1, 0.1) * albedoColor;\n\t\t\t\tfinalColor += ambient;\n\n\t\t\t\t// \u9ad8\u5149\u8ba1\u7b97\n\t\t\t\tfloat3 viewDir = normalize(GetWorldSpaceViewDir(input.positionWS));\n\t\t\t\tfloat3 halfVector = normalize(mainLight.direction + viewDir);\n\t\t\t\tfloat NdotH = max(0, dot(normalWS, halfVector));\n\t\t\t\tfloat specularRamp = smoothstep(_SpecularThreshold - _SpecularSmoothness, _SpecularThreshold + _SpecularSmoothness, NdotH);\n\t\t\t\thalf3 specular = _SpecularColor.rgb * specularRamp;\n\t\t\t\tfinalColor += specular;\n\n\t\t\t\treturn half4(finalColor, 1);\n\t\t\t\t\n\t\t\t}\n\t\t\tENDHLSL\n\t\t}\n\n\t\t// \u7b2c\u4e8c\u4e2aPass - \u8f6e\u5ed3\u7ebf\n\t\tPass\n\t\t{\n\t\t\tName "Outline"\n\t\t\tTags {}\n\t\t\tCull Front //\u8e22\u51fa\u6b63\u9762  \u53ea\u6e32\u67d3\u80cc\u9762\n\t\t\tHLSLPROGRAM\n\t\t\t#pragma vertex vert\n\t\t\t#pragma fragment frag\n\n\t\t\t#include "Packages/com.unity.render-pipelines.universal/ShaderLibrary/Core.hlsl"\n\n\t\t\tCBUFFER_START(UnityPerMaterial)\n\t\t\tfloat4 _OutlineColor;\n\t\t\tfloat _OutlineWidth;\n\t\t\tCBUFFER_END\n\n\t\t\tstruct Attributes\n\t\t\t{\n\t\t\t\tfloat4 positionOS : POSITION;\n\t\t\t\tfloat3 normalOS : NORMAL;\n\t\t\t};\n\n\t\t\tstruct Varyings\n\t\t\t{\n\t\t\t\tfloat4 positionCS : SV_POSITION;\n\t\t\t};\n\n\t\t\tVaryings vert(Attributes input)\n\t\t\t{\n\t\t\t\tVaryings output;\n\n\t\t\t\t// \u6cd5\u7ebf\u65b9\u5411\u5916\u6269\u70b9\n\t\t\t\tfloat3 positionOS = input.positionOS.xyz + input.normalOS * _OutlineWidth;\n\t\t\t\toutput.positionCS = TransformObjectToHClip(positionOS);\n\t\t\t\treturn output;\n\t\t\t}\n\n\t\t\thalf4 frag(Varyings input) : SV_TARGET\n\t\t\t{\n\t\t\t\treturn _OutlineColor;\n\t\t\t}\n\n\t\t\tENDHLSL\n\t\t}\n\n\t\t// // \u7b2c\u4e09\u4e2aPass - \u6295\u5c04\u9634\u5f71\n\t\t// UsePass "Universal Render Pipeline/Lit/ShadowCaster"\n\t}\n}\n'})})]})}function d(t={}){const{wrapper:n}={...(0,r.R)(),...t.components};return n?(0,a.jsx)(n,{...t,children:(0,a.jsx)(u,{...t})}):u(t)}},7408:(t,n,o)=>{o.d(n,{A:()=>e});const e=o.p+"assets/images/toonshadingAdvanced-0ef58620954e40590cc7689b3840935b.gif"},8453:(t,n,o)=>{o.d(n,{R:()=>l,x:()=>i});var e=o(6540);const a={},r=e.createContext(a);function l(t){const n=e.useContext(r);return e.useMemo((function(){return"function"==typeof t?t(n):{...n,...t}}),[n,t])}function i(t){let n;return n=t.disableParentContext?"function"==typeof t.components?t.components(a):t.components||a:l(t.components),e.createElement(r.Provider,{value:n},t.children)}}}]);